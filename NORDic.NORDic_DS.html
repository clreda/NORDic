<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NORDic.NORDic_DS package &mdash; NORDic v2.4.3 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=f9fa89a7"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="NORDic.NORDic_NI package" href="NORDic.NORDic_NI.html" />
    <link rel="prev" title="NORDic.NORDic_DR package" href="NORDic.NORDic_DR.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            NORDic
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="content.html">Statement of need</a></li>
<li class="toctree-l1"><a class="reference internal" href="content.html#usage">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">NORDic</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="NORDic.html">NORDic package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="NORDic.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="NORDic.NORDic_DR.html">NORDic.NORDic_DR package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">NORDic.NORDic_DS package</a></li>
<li class="toctree-l4"><a class="reference internal" href="NORDic.NORDic_NI.html">NORDic.NORDic_NI package</a></li>
<li class="toctree-l4"><a class="reference internal" href="NORDic.NORDic_PMR.html">NORDic.NORDic_PMR package</a></li>
<li class="toctree-l4"><a class="reference internal" href="NORDic.UTILS.html">NORDic.UTILS package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="NORDic.html#module-NORDic">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NORDic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">NORDic</a></li>
          <li class="breadcrumb-item"><a href="NORDic.html">NORDic package</a></li>
      <li class="breadcrumb-item active">NORDic.NORDic_DS package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/NORDic.NORDic_DS.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nordic-nordic-ds-package">
<h1>NORDic.NORDic_DS package<a class="headerlink" href="#nordic-nordic-ds-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-NORDic.NORDic_DS.functions">
<span id="nordic-nordic-ds-functions-module"></span><h2>NORDic.NORDic_DS.functions module<a class="headerlink" href="#module-NORDic.NORDic_DS.functions" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.functions.baseline">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.functions.</span></span><span class="sig-name descname"><span class="pre">baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signatures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phenotype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.functions.baseline" title="Permalink to this definition"></a></dt>
<dd><p>Compute the cosine scores between a set of signatures S and a differential phenotype P</p>
<p>…</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>S<span class="classifier">Pandas DataFrame</span></dt><dd><p>signatures rows/[genes] x columns/[drug names] [Treated || Control]</p>
</dd>
<dt>P<span class="classifier">Pandas DataFrame</span></dt><dd><p>differential phenotype rows/[genes] x column/[disease name] [Diseased || Healthy]</p>
</dd>
<dt>is_binary<span class="classifier">Python bool</span></dt><dd><p>[default=False] : if set to True, the signatures and phenotypes might be binary (that is, with values in {0,1})</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>scores<span class="classifier">Python float dictionary</span></dt><dd><p>dictionary (keys=drug names, values=scores), the higher the score, the higher the repurposing power</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.functions.compute_frontier">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.functions.</span></span><span class="sig-name descname"><span class="pre">compute_frontier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.functions.compute_frontier" title="Permalink to this definition"></a></dt>
<dd><p>Fit a model to classify control/treated phenotypes</p>
<p>…</p>
<section id="id1">
<h3>Parameters<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>df<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[genes] x columns/[samples] (either 1: active expression, -1: inactive expression, 0: undetermined expression)</p>
</dd>
<dt>samples<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[“annotation”] x columns/[samples ], values are 1 (healthy sample) or 2 (patient sample).</p>
</dd>
<dt>nbseed<span class="classifier">Python integer</span></dt><dd><p>[default=0] : random seed</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>[default=False] : prints out verbose</p>
</dd>
</dl>
</section>
<section id="id2">
<h3>Returns<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>model<span class="classifier">Python object</span></dt><dd><p>object with a function “predict” that returns predictions (1: control, or 2: treated) on phenotypes</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.functions.compute_metrics">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.functions.</span></span><span class="sig-name descname"><span class="pre">compute_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">5,</span> <span class="pre">10]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_negative_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.functions.compute_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Compute AUC, Hit Ratio &#64; k of method for positive/negative class with p-value</p>
<p>…</p>
<section id="id3">
<h3>Parameters<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>rewards<span class="classifier">Python float list</span></dt><dd><p>predicted scores</p>
</dd>
<dt>ground_truth<span class="classifier">Python float list</span></dt><dd><p>ground truth scores</p>
</dd>
<dt>K<span class="classifier">Python integer list</span></dt><dd><p>[default=[2,5,10]] : ranks at which the hit ratio should be computed</p>
</dd>
<dt>use_negative_class<span class="classifier">Python bool</span></dt><dd><p>[default=False] : if set to True, compute the performance with respect to the negative class instead of the positive class</p>
</dd>
<dt>nperms<span class="classifier">Python integer</span></dt><dd><p>[default=10000] : number of permutations to perform</p>
</dd>
<dt>thres<span class="classifier">Python float</span></dt><dd><p>[default=0.] : decision threshold to determine the positive (resp. negative) class</p>
</dd>
<dt>beta<span class="classifier">Python float</span></dt><dd><p>[default=1.] : value of the coefficient in the F-measure</p>
</dd>
</dl>
</section>
<section id="id4">
<h3>Returns<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>res_di<span class="classifier">Python dictionary</span></dt><dd><p>(keys=metrics, values=values of the metrics)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.functions.compute_score">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.functions.</span></span><span class="sig-name descname"><span class="pre">compute_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_sims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.functions.compute_score" title="Permalink to this definition"></a></dt>
<dd><p>Compute similarities between any attractor in WT and in mutants, weighted by their probabilities</p>
<p>…</p>
<section id="id5">
<h3>Parameters<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>f<span class="classifier">Boolean Network (MPBN) object</span></dt><dd><p>the mutated network</p>
</dd>
<dt>x0<span class="classifier">MPBN object</span></dt><dd><p>initial state</p>
</dd>
<dt>A<span class="classifier">Attractor list</span></dt><dd><p>list of attractors in mutant network</p>
</dd>
<dt>score<span class="classifier">Python object</span></dt><dd><p>scoring of attractors</p>
</dd>
<dt>genes<span class="classifier">Python character string list</span></dt><dd><p>list of genes in the model frontier</p>
</dd>
<dt>nb_sims<span class="classifier">Python integer</span></dt><dd><p>number of iterations to compute the probabilities</p>
</dd>
<dt>experiments<span class="classifier">Python dictionary list</span></dt><dd><p>list of experiments (different rates/depths)</p>
</dd>
<dt>repeat<span class="classifier">Python integer</span></dt><dd><p>[default=1] : how many times should these experiments be repeated</p>
</dd>
<dt>exp_name<span class="classifier">Python character string</span></dt><dd><p>[default=””] : printable for an experiment</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>[default=False] : prints out verbose</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Returns<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>score<span class="classifier">Python float</span></dt><dd><p>change in attractors induced by the mutation</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.functions.empirical_pvalue">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.functions.</span></span><span class="sig-name descname"><span class="pre">empirical_pvalue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sorted_rewards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted_ground_truth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ks_2samp'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.functions.empirical_pvalue" title="Permalink to this definition"></a></dt>
<dd><p>Compute an empirical p-value corresponding to testing whether the distributions in the predicted scores and the ground truth are similar by randomly permuting the values of the predictions and averaging the number of significant statistics across all permutations</p>
<p>…</p>
<section id="id7">
<h3>Parameters<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>sorted_rewards<span class="classifier">Python float list</span></dt><dd><p>predicted scores sorted by genes of increasing predicted value</p>
</dd>
<dt>sorted_ground_truth<span class="classifier">Python float list</span></dt><dd><p>ground truth scores sorted by genes of increasing predicted value</p>
</dd>
<dt>nperms<span class="classifier">Python integer</span></dt><dd><p>number of permutations to perform</p>
</dd>
<dt>method<span class="classifier">Python character string</span></dt><dd><p>[default=”ks_2samp”] : statistical test to perform at each permutation (should belong to scipy.stats)</p>
</dd>
</dl>
</section>
<section id="id8">
<h3>Returns<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>pvalue<span class="classifier">Python float</span></dt><dd><p>empirical p-value corresponding to the test across all &#64;nperms permutations</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.functions.simulate">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.functions.</span></span><span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simu_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.functions.simulate" title="Permalink to this definition"></a></dt>
<dd><p>Simulate and score the individual effects of drugs on patient phenotypes, compared to controls</p>
<p>…</p>
<section id="id9">
<h3>Parameters<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>network_fname<span class="classifier">Python character string</span></dt><dd><p>(relative) path to a network .BNET file</p>
</dd>
<dt>targets<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[genes] x columns/[drugs to test] (either 1: active expression, -1: inactive expression, 0: undetermined expression)</p>
</dd>
<dt>patients<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[genes] x columns/[samples] (either 1: activatory, -1: inhibitory, 0: no regulation).</p>
</dd>
<dt>score<span class="classifier">Python object</span></dt><dd><p>scoring of attractors</p>
</dd>
<dt>simu_params<span class="classifier">Python dictionary</span></dt><dd><p>[default={}] : arguments to MPBN-SIM</p>
</dd>
<dt>nbseed<span class="classifier">Python integer</span></dt><dd><p>[default=0] : random seed</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>[default=False] : prints out verbose</p>
</dd>
</dl>
</section>
<section id="id10">
<h3>Returns<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>scores<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[patient phenotypes] x columns/[drug names], values are the associated scores</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.functions.simulate_treatment">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.functions.</span></span><span class="sig-name descname"><span class="pre">simulate_treatment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simu_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.functions.simulate_treatment" title="Permalink to this definition"></a></dt>
<dd><p>Compute the score assigned to a drug with targets in &#64;targets[[drug]] in network</p>
<p>…</p>
<section id="id11">
<h3>Parameters<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>network_name<span class="classifier">Python character string</span></dt><dd><p>filename of the network in .bnet (needs to be pickable)</p>
</dd>
<dt>targets<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[genes] x columns/[columns]</p>
</dd>
<dt>score<span class="classifier">Python object</span></dt><dd><p>scoring of attractors</p>
</dd>
<dt>state<span class="classifier">Pandas DataFrame</span></dt><dd><p>binary patient initial state rows/[genes] x columns/[values in {-1,0,1}]</p>
</dd>
<dt>simu_params<span class="classifier">Python dictionary</span></dt><dd><p>[default={}] : arguments to MPBN-SIM</p>
</dd>
<dt>seednb<span class="classifier">Python integer</span></dt><dd><p>[default=0] : random seed</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>[default=False] : prints out verbose</p>
</dd>
</dl>
</section>
<section id="id12">
<h3>Returns<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>effects<span class="classifier">Python float dictionary</span></dt><dd><p>distance from attractors from treated networks to control profiles</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-NORDic.NORDic_DS.get_drug_signatures">
<span id="nordic-nordic-ds-get-drug-signatures-module"></span><h2>NORDic.NORDic_DS.get_drug_signatures module<a class="headerlink" href="#module-NORDic.NORDic_DS.get_drug_signatures" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_signatures.compute_drug_signatures_L1000">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_signatures.</span></span><span class="sig-name descname"><span class="pre">compute_drug_signatures_L1000</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pubchem_cids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lincs_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binarize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_signatures.compute_drug_signatures_L1000" title="Permalink to this definition"></a></dt>
<dd><p>Get drug signatures from LINCS L1000</p>
<p>…</p>
<section id="id13">
<h3>Parameters<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>pubchem_cids<span class="classifier">Python integer list</span></dt><dd><p>list of drug PubChem CIDs</p>
</dd>
<dt>lincs_args<span class="classifier">Python dictionary</span></dt><dd><p>additional arguments for LINCS L1000 requests</p>
</dd>
<dt>binarize<span class="classifier">Python bool</span></dt><dd><p>[default=True] : should the resulting signatures be binarized?</p>
</dd>
</dl>
</section>
<section id="id14">
<h3>Returns<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>sigs<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[genes] x columns/[drug names]</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_signatures.drugname2pubchem">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_signatures.</span></span><span class="sig-name descname"><span class="pre">drugname2pubchem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drug_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lincs_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_signatures.drugname2pubchem" title="Permalink to this definition"></a></dt>
<dd><p>Convert drug names into PubChem CIDs</p>
<p>…</p>
<section id="id15">
<h3>Parameters<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>drug_names<span class="classifier">Python character string list</span></dt><dd><p>list of drug names</p>
</dd>
<dt>lincs_args<span class="classifier">Python dictionary</span></dt><dd><p>additional arguments for LINCS L1000 requests</p>
</dd>
</dl>
</section>
<section id="id16">
<h3>Returns<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>pubchem_cids<span class="classifier">Python dictionary</span></dt><dd><p>(keys=drug names, values=PubChem CIDs)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_signatures.get_ranking">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_signatures.</span></span><span class="sig-name descname"><span class="pre">get_ranking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CD</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_signatures.get_ranking" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve ranking (50 first drugs) from L1000 CDS^2 search engine</p>
<p>…</p>
<section id="id17">
<h3>Parameters<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>CD<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[genes] x column/[value] differential phenotype</p>
</dd>
</dl>
</section>
<section id="id18">
<h3>Returns<a class="headerlink" href="#id18" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>resuls<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[drug names] x column/[“L1000 CDS2”] ranking of the drugs according to their ability to reverse the phenotype</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_signatures.pubchem2drugname">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_signatures.</span></span><span class="sig-name descname"><span class="pre">pubchem2drugname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pubchem_cids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lincs_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_signatures.pubchem2drugname" title="Permalink to this definition"></a></dt>
<dd><p>Convert drug names into PubChem CIDs</p>
<p>…</p>
<section id="id19">
<h3>Parameters<a class="headerlink" href="#id19" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>pubchem_cids<span class="classifier">Python integer list</span></dt><dd><p>list of drug PubChem CIDs</p>
</dd>
<dt>lincs_args<span class="classifier">Python dictionary</span></dt><dd><p>additional arguments for LINCS L1000 requests</p>
</dd>
</dl>
</section>
<section id="id20">
<h3>Returns<a class="headerlink" href="#id20" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>pert_inames<span class="classifier">Python dictionary</span></dt><dd><p>(keys=PubChem CIDs, values=drug names)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_signatures.retrieve_drug_signature">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_signatures.</span></span><span class="sig-name descname"><span class="pre">retrieve_drug_signature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pubchem_cid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lincs_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binarize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_signatures.retrieve_drug_signature" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve control &amp; treated samples from LINCS L1000 and compute the corresponding drug signature</p>
<p>…</p>
<section id="id21">
<h3>Parameters<a class="headerlink" href="#id21" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>pubchem_cid<span class="classifier">Python integer</span></dt><dd><p>drug PubChem CID</p>
</dd>
<dt>cell_ids<span class="classifier">Python character string list</span></dt><dd><p>list of candidate cell lines in LINCS L1000</p>
</dd>
<dt>gene_list<span class="classifier">Python integer list</span></dt><dd><p>list of EntrezID genes</p>
</dd>
<dt>lincs_args<span class="classifier">Python dictionary</span></dt><dd><p>additional arguments for LINCS L1000 requests</p>
</dd>
<dt>binarize<span class="classifier">Python bool</span></dt><dd><p>should the resulting signatures be binarized?</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>[default=False] : prints out verbose</p>
</dd>
</dl>
</section>
<section id="id22">
<h3>Returns<a class="headerlink" href="#id22" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>sig<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[genes] x column/[drug PubChem]</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-NORDic.NORDic_DS.get_drug_targets">
<span id="nordic-nordic-ds-get-drug-targets-module"></span><h2>NORDic.NORDic_DS.get_drug_targets module<a class="headerlink" href="#module-NORDic.NORDic_DS.get_drug_targets" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_targets.get_targets_DrugBank">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_targets.</span></span><span class="sig-name descname"><span class="pre">get_targets_DrugBank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drug_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_drugbank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drug_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_targets.get_targets_DrugBank" title="Permalink to this definition"></a></dt>
<dd><p>Utility function which gets drug targets from a local DrugBank database</p>
<p>…</p>
<section id="id23">
<h3>Parameters<a class="headerlink" href="#id23" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>drug_names<span class="classifier">Python character string list</span></dt><dd><p>list of common drug names</p>
</dd>
<dt>path_to_drugbank<span class="classifier">Python character string</span></dt><dd><p>(relative) path to DrugBank files</p>
</dd>
<dt>drug_fname<span class="classifier">Python character string</span></dt><dd><p>file name of .XML file of the complete database (full_database.xml) in DrugBank</p>
</dd>
<dt>target_fname<span class="classifier">Python character string</span></dt><dd><p>file name of .CSV file of the protein targets (all.csv) in DrugBank</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>prints out verbose (default=False)</p>
</dd>
</dl>
</section>
<section id="id24">
<h3>Returns<a class="headerlink" href="#id24" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>target_df<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[lists of HGNC symbols of targets] x columns/[drug names], values are “*” (known regulator) or “” (no known regulation)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_targets.get_targets_DrugCentral">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_targets.</span></span><span class="sig-name descname"><span class="pre">get_targets_DrugCentral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drug_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_targets.get_targets_DrugCentral" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to retrieve drug targets from the DrugCentral 2021</p>
<p>…</p>
<section id="id25">
<h3>Parameters<a class="headerlink" href="#id25" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>drug_name<span class="classifier">Python character string list</span></dt><dd><p>list of common drug names</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>prints out verbose (default=False)</p>
</dd>
</dl>
</section>
<section id="id26">
<h3>Returns<a class="headerlink" href="#id26" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>target_df<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[lists of HGNC symbols of targets] x columns/[drug names], values are “*” (known regulator) or “” (no known regulation)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_targets.get_targets_LINCS">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_targets.</span></span><span class="sig-name descname"><span class="pre">get_targets_LINCS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drug_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_lincs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">credentials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_targets.get_targets_LINCS" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to retrieve drug targets from the LINCS L1000 database</p>
<p>…</p>
<section id="id27">
<h3>Parameters<a class="headerlink" href="#id27" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>drug_names<span class="classifier">Python character string list</span></dt><dd><p>list of common drug names</p>
</dd>
<dt>path_to_lincs<span class="classifier">Python character string</span></dt><dd><p>(relative) path to LINCS files</p>
</dd>
<dt>credentials<span class="classifier">Python character string</span></dt><dd><p>(relative) path to LINCS credentials file</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>prints out verbose (default=False)</p>
</dd>
</dl>
</section>
<section id="id28">
<h3>Returns<a class="headerlink" href="#id28" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>target_df<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[lists of HGNC symbols of targets] x columns/[drug names], values are “*” (known regulator) or “” (no known regulation)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_targets.get_targets_MINERVA">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_targets.</span></span><span class="sig-name descname"><span class="pre">get_targets_MINERVA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drug_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_targets.get_targets_MINERVA" title="Permalink to this definition"></a></dt>
<dd><p>Utility function using httr:GET to send queries to a given MINERVA Platform instance</p>
<p>…</p>
<section id="id29">
<h3>Parameters<a class="headerlink" href="#id29" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>drug_names<span class="classifier">Python character string list</span></dt><dd><p>list of common drug names</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>[default=False] : prints out verbose</p>
</dd>
</dl>
</section>
<section id="id30">
<h3>Returns<a class="headerlink" href="#id30" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>target_df<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[lists of HGNC symbols of targets] x columns/[drug names], values are “*” (known regulator) or “” (no known regulation)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_targets.get_targets_TTD">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_targets.</span></span><span class="sig-name descname"><span class="pre">get_targets_TTD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drug_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_targets.get_targets_TTD" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to retrieve drug targets from the Therapeutic Target Database (TTD)</p>
<p>…</p>
<section id="id31">
<h3>Parameters<a class="headerlink" href="#id31" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>drug_name<span class="classifier">Python character string list</span></dt><dd><p>list of common drug names</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>prints out verbose (default=False)</p>
</dd>
</dl>
</section>
<section id="id32">
<h3>Returns<a class="headerlink" href="#id32" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>target_df<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[lists of HGNC symbols of targets] x columns/[drug names], values are “-” (inhibitor) or “+” (activator) or “” (no known regulation)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="NORDic.NORDic_DS.get_drug_targets.retrieve_drug_targets">
<span class="sig-prename descclassname"><span class="pre">NORDic.NORDic_DS.get_drug_targets.</span></span><span class="sig-name descname"><span class="pre">retrieve_drug_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drug_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TARGET_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['DrugBank',</span> <span class="pre">'MINERVA',</span> <span class="pre">'LINCS',</span> <span class="pre">'TTD',</span> <span class="pre">'DrugCentral']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#NORDic.NORDic_DS.get_drug_targets.retrieve_drug_targets" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve drug targets from several online sources</p>
<p>…</p>
<section id="id33">
<h3>Parameters<a class="headerlink" href="#id33" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>drug_names<span class="classifier">Python character string list</span></dt><dd><p>list of common drug names</p>
</dd>
<dt>TARGET_args<span class="classifier">Python dictionary</span></dt><dd><p>[default={}] : see for each source</p>
</dd>
<dt>gene_list<span class="classifier">Python character string list</span></dt><dd><p>[default=[]] : list of HGNC symbols</p>
</dd>
<dt>sources<span class="classifier">Python character string list</span></dt><dd><p>[default=[“DrugBank”,”MINERVA”,”LINCS”,”TTD”,”DrugCentral”]] : list of source names (in [“DrugBank”,”MINERVA”,”LINCS”,”TTD”,”DrugCentral”])</p>
</dd>
<dt>quiet<span class="classifier">Python bool</span></dt><dd><p>[default=False] : prints out verbose</p>
</dd>
</dl>
</section>
<section id="id34">
<h3>Returns<a class="headerlink" href="#id34" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>targets_df<span class="classifier">Pandas DataFrame</span></dt><dd><p>rows/[genes] x columns/[drug names], values are the number of times a target is connected to a drug across all queried databases</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-NORDic.NORDic_DS">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-NORDic.NORDic_DS" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="NORDic.NORDic_DR.html" class="btn btn-neutral float-left" title="NORDic.NORDic_DR package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="NORDic.NORDic_NI.html" class="btn btn-neutral float-right" title="NORDic.NORDic_NI package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Clémence Réda, Andrée Delahaye-Duriez.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>